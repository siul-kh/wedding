<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>모바일 청첩장</title>

  <!-- (선택) 폰트 프리로드: 폰트 파일이 없으면 자동으로 무시되지만, 있어도 렌더는 막지 않음 -->
  <link rel="preload" href="fonts/GowunBatang-Regular.woff2?v=1" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="fonts/GowunBatang-Bold.woff2?v=1" as="font" type="font/woff2" crossorigin>

  <style>
    /* 폰트: 파일이 없어도 기본 폰트로 표시됨 (화면은 뜸) */
    @font-face{
      font-family:'GowunBatang';
      src:url('fonts/GowunBatang-Regular.woff2?v=1') format('woff2'),
          url('fonts/GowunBatang-Regular.ttf?v=1') format('truetype');
      font-weight:400; font-style:normal; font-display:swap;
    }
    @font-face{
      font-family:'GowunBatang';
      src:url('fonts/GowunBatang-Bold.woff2?v=1') format('woff2'),
          url('fonts/GowunBatang-Bold.ttf?v=1') format('truetype');
      font-weight:700; font-style:normal; font-display:swap;
    }

    :root{
      --maxw:414px;
      --ink:#585353;
      --muted:#e9e9e9;
      --thin:#e5e5e5;
      --accent:#7b9155;
      --hint:#9d9b9b;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0; background:#fff; color:var(--ink);
      font-family:'GowunBatang', ui-serif, system-ui, serif;
      font-size:12pt; line-height:1.8;
      display:flex; justify-content:center;
    }
    .container{width:100%; max-width:var(--maxw)}
    section{margin:0; background:#fff}
    .pad{padding:24px 16px}
    .center{text-align:center}
    .thin{height:1px; background:var(--thin); margin:16px 0}

    /* 시 */
    .poem p{margin:8px 0}
    .poem .big{font-size:14pt; color:#585353; font-weight:700}
    .poem .normal{font-size:12pt; color:#585353}

    /* 사진 자리 */
    .portrait-ph{width:100%; aspect-ratio:9/16; background:#f2f2f2; display:grid; place-items:center; color:#777}

    /* 카운트다운 */
    .when .title{font-size:14pt; color:var(--accent); font-weight:700}
    .when .meta{opacity:.9}
    .labels{font-size:6pt; color:var(--hint); letter-spacing:.12em; margin-top:8px}
    .timer{font-size:14pt; color:#585353; margin-top:6px; display:flex; justify-content:center; gap:6px; align-items:baseline}
    .colon{opacity:.7}

    /* 오시는 길 */
    .map iframe{width:100%; aspect-ratio:1/1; border:0}
    .nav-apps{display:grid; grid-template-columns:1fr 1fr 1fr; gap:8px; margin-top:12px}
    .nav-btn{display:inline-flex; align-items:center; justify-content:center; padding:10px 12px; font-size:10pt; color:#585353; text-decoration:none; background:#fff; border:1px solid var(--thin); border-radius:10px; cursor:pointer}

    /* 갤러리 */
    .gallery{padding:16px}
    .hero-photo{position:relative; overflow:hidden}
    .hero-photo img{width:100%; display:block}
    .slide-nav{position:absolute; inset:auto 8px 8px auto; display:flex; gap:8px}
    .slide-nav button{border:1px solid #000; background:#000; color:#fff; padding:6px 10px; cursor:pointer}
    .thumbs{display:grid; grid-template-columns:repeat(4,1fr); gap:6px; margin-top:10px}
    .thumbs button{padding:0; border:1px solid var(--thin); aspect-ratio:1/1; overflow:hidden; cursor:pointer; background:#fff}
    .thumbs img{width:100%; height:100%; object-fit:cover; display:block}

    /* 방명록 */
    .gb-head{display:flex; justify-content:space-between; align-items:center; margin-bottom:10px}
    .gb-list{display:grid; gap:10px}
    .card{border:1px solid var(--thin); padding:12px}
    .pager{display:flex; gap:6px; align-items:center}
    .pager button{border:1px solid var(--thin); background:#fff; padding:6px 10px; cursor:pointer}
    .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.45); z-index:100}
    .modal.open{display:grid}
    .sheet{width:min(92vw,420px); background:#fff; border:1px solid var(--thin)}
    .sheet .hd{display:flex; justify-content:flex-end}
    .sheet .hd button{border:none; background:transparent; font-size:18px; padding:8px 10px; cursor:pointer}
    .sheet .body{padding:16px; display:grid; gap:10px}
    input, textarea{width:100%; padding:10px; border:1px solid var(--thin); font:inherit}
    .copy-modal .sheet{width:min(92vw,360px)}

    /* 마음 전하실 곳 */
    .acc-title{font-size:14pt; font-weight:700; color:#585353; text-align:center; margin-bottom:10px}
    .acc-toggle{width:100%; border:none; border-radius:12px; background:#9d9b9b; color:#7b9155; font-size:12pt; font-weight:700; padding:12px 14px; text-align:left; cursor:pointer; display:flex; align-items:center; justify-content:space-between}
    .acc-toggle .chev{transition:transform .25s ease}
    .acc-toggle[aria-expanded="true"] .chev{transform:rotate(180deg)}
    .acc-panel{display:none; margin-top:10px}
    .acc-panel.open{display:block}
    .acc-table{width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:12px; border:1px solid var(--thin); background:#fff}
    .acc-table tbody td{padding:10px; border-top:1px solid var(--thin); vertical-align:middle}
    .acc-line{font-size:10pt; color:#585353}
    .copy-mini{padding:6px 10px; border:none; border-radius:10px; background:#9d9b9b; color:#fff; cursor:pointer; font-size:10pt}
    .copy-col{width:70px; text-align:right}

    /* 공유 */
    .share-box{text-align:center; padding:20px 16px 40px}
    .share-btn{display:inline-flex; padding:12px 14px; border:1px solid var(--thin); background:#fff; cursor:pointer}

    /* 아래→위 슬라이드 + 페이드 */
    @keyframes slideBySelfHeight{0%{transform:translateY(100%); opacity:0}100%{transform:translateY(0); opacity:1}}
    .reveal-up{transform:translateY(100%); opacity:0; will-change:transform,opacity}
    .reveal-up.show{animation:slideBySelfHeight 2s cubic-bezier(.2,.7,.2,1) forwards}
    @media (prefers-reduced-motion:reduce){.reveal-up{transform:none; opacity:1}.reveal-up.show{animation:none}}
  </style>
</head>
<body>
  <main class="container">

    <!-- 시 -->
    <section class="pad poem reveal-up">
      <p class="big">13년 전,</p>
      <p class="big">우리는 처음 만나 나무를 심었습니다.</p>
      <p class="normal">여린 묘목에 흙과 물을 주고,<br>적당한 햇살이 비치기를,<br>적당한 바람이 불기를 바랐습니다.</p>
      <p class="normal">맘과 달리 적당하지 않은 날이<br>많았는지도 모르겠습니다.</p>
      <p class="normal">그 덕에 적당한 목질이 되어<br>이제는 제법 단단한 뿌리를 뻗고,<br>위로는 숱한 가지를 내어<br>그늘을 만들었습니다.</p>
      <p class="normal">그 아래서 우리는<br>적당한 날들을 맞이하려 합니다.</p>
    </section>

    <!-- 세로 비율 사진 -->
    <section class="portrait-ph reveal-up">세로 비율 사진 자리</section>

    <!-- 카운트다운(경과) -->
    <section class="pad when center reveal-up">
      <div class="title">우리가 나무를 심은 날</div>
      <div class="meta">2012. 06. 09. SAT. 08:30, 남산원</div>
      <div class="labels">DAYS&nbsp;&nbsp;HOUR&nbsp;&nbsp;MIN&nbsp;&nbsp;SEC</div>
      <div id="countPast" class="timer" aria-label="경과 시간">
        <span class="d">00</span><span class="colon"> : </span>
        <span class="h">00</span><span class="colon"> : </span>
        <span class="m">00</span><span class="colon"> : </span>
        <span class="s">00</span>
      </div>
    </section>

    <!-- 카운트다운(남은) -->
    <section class="pad when center reveal-up">
      <div class="title">그 나무가 열매를 맺을 날</div>
      <div class="meta">2025. 11. 01. SAT. 14:00, 서울행정법원 융선당</div>
      <div class="labels">DAYS&nbsp;&nbsp;HOUR&nbsp;&nbsp;MIN&nbsp;&nbsp;SEC</div>
      <div id="countFuture" class="timer" aria-label="남은 시간">
        <span class="d">00</span><span class="colon"> : </span>
        <span class="h">00</span><span class="colon"> : </span>
        <span class="m">00</span><span class="colon"> : </span>
        <span class="s">00</span>
      </div>
    </section>

    <div class="thin"></div>

    <!-- 오시는 길 -->
    <section class="pad reveal-up">
      <div class="center" style="font-size:14pt; font-weight:700; color:#585353">오시는 길</div>
      <div class="map" style="margin-top:10px">
        <iframe title="서울가정행정법원 융선당"
                src="https://www.google.com/maps?q=%EC%84%9C%EC%9A%B8%EA%B0%80%EC%A0%95%ED%96%89%EC%A0%95%EB%B2%95%EC%9B%90%20%EC%9C%B5%EC%84%A0%EB%8B%B9&output=embed"
                loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
      <div class="center" style="margin-top:12px">
        <div style="font-size:14pt; color:#585353">서울행정법원 융선당</div>
        <div>서울시 서초구 강남대로 193(양재동 25-3)</div>
        <div style="margin-top:10px">
          3호선 • 신분당선 양재역 9번 출구 도보 3분 직진<br>
          16시까지 지하 3~4층 주차장 이용 가능<br>
          13시 30분부터 식사 가능
        </div>
      </div>
      <div class="nav-apps">
        <a class="nav-btn" target="_blank" rel="noopener" href="https://map.naver.com/v5/search/%EC%84%9C%EC%9A%B8%ED%96%89%EC%A0%95%EB%B2%95%EC%9B%90%20%EC%9C%B5%EC%84%A0%EB%8B%B9%EC%98%88%EC%8B%9D%EC%9E%A5">네이버 지도</a>
        <a class="nav-btn" target="_blank" rel="noopener" href="https://www.tmap.co.kr/tmap2/mobile/route.do">티맵</a>
        <a class="nav-btn" target="_blank" rel="noopener" href="https://map.kakao.com/?q=%EC%84%9C%EC%9A%B8%ED%96%89%EC%A0%95%EB%B2%95%EC%9B%90%20%EC%9C%B5%EC%84%A0%EB%8B%B9%EC%98%88%EC%8B%9D%EC%9E%A5">카카오내비</a>
      </div>
    </section>

    <div class="thin"></div>

    <!-- 갤러리 -->
    <section class="gallery" id="gallery">
      <div class="center" style="font-weight:700; color:#585353; margin-bottom:8px">갤러리</div>
      <div class="hero-photo">
        <img id="heroImg" alt="큰 사진">
        <div class="slide-nav">
          <button id="prevBtn" aria-label="이전">이전</button>
          <button id="nextBtn" aria-label="다음">다음</button>
        </div>
      </div>
      <div class="thumbs" id="thumbs"></div>
    </section>

    <div class="thin"></div>

    <!-- 방명록 -->
    <section class="pad" id="guestbook">
      <div class="gb-head">
        <div style="font-weight:700; color:#585353">방명록</div>
        <div class="pager">
          <button id="prevPage">이전</button>
          <span id="pageInfo">1 / 1</span>
          <button id="nextPage">다음</button>
          <button id="writeBtn" style="margin-left:8px">작성하기</button>
        </div>
      </div>
      <div id="gbList" class="gb-list"></div>
    </section>

    <!-- 방명록 작성 팝업 -->
    <div id="gbModal" class="modal">
      <div class="sheet">
        <div class="hd"><button id="gbClose" aria-label="닫기">✕</button></div>
        <div class="body">
          <input id="gbName" placeholder="이름"/>
          <textarea id="gbMsg" rows="4" placeholder="내용"></textarea>
          <button id="gbSubmit" class="nav-btn" style="justify-content:center">신랑 &amp; 신부에게 축하 글 전달하기</button>
        </div>
      </div>
    </div>

    <div class="thin"></div>

    <!-- 마음 전하실 곳 (토글 + 표 + 복사) -->
    <section class="pad" id="accounts">
      <div class="acc-title">마음 전하실 곳</div>

      <button class="acc-toggle" type="button" aria-expanded="false" data-target="#accGroom">
        <span>신랑 측</span><span class="chev">⌄</span>
      </button>
      <div id="accGroom" class="acc-panel" hidden>
        <table class="acc-table" style="margin-top:10px">
          <tbody>
            <tr><td class="acc-line">김기환 국민은행 90513110424</td><td class="copy-col"><button class="copy-mini" data-copy="국민은행 90513110424 (김기환)">복사</button></td></tr>
            <tr><td class="acc-line">김정호 국민은행 430502-93-118573</td><td class="copy-col"><button class="copy-mini" data-copy="국민은행 430502-93-118573 (김정호)">복사</button></td></tr>
            <tr><td class="acc-line">이이순 우리은행 1002-038-271451</td><td class="copy-col"><button class="copy-mini" data-copy="우리은행 1002-038-271451 (이이순)">복사</button></td></tr>
          </tbody>
        </table>
      </div>

      <div style="height:10px"></div>

      <button class="acc-toggle" type="button" aria-expanded="false" data-target="#accBride">
        <span>신부 측</span><span class="chev">⌄</span>
      </button>
      <div id="accBride" class="acc-panel" hidden>
        <table class="acc-table" style="margin-top:10px">
          <tbody>
            <tr><td class="acc-line">목지선 카카오뱅크 3333-22-7850739</td><td class="copy-col"><button class="copy-mini" data-copy="카카오뱅크 3333-22-7850739 (목지선)">복사</button></td></tr>
            <tr><td class="acc-line">목승우 국민은행 65940101191168</td><td class="copy-col"><button class="copy-mini" data-copy="국민은행 65940101191168 (목승우)">복사</button></td></tr>
            <tr><td class="acc-line">성미화 새마을금고 9002197239365</td><td class="copy-col"><button class="copy-mini" data-copy="새마을금고 9002197239365 (성미화)">복사</button></td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- 복사 완료 팝업 -->
    <div id="copyModal" class="modal copy-modal">
      <div class="sheet">
        <div class="hd"><button id="copyClose" aria-label="닫기">✕</button></div>
        <div class="body center">복사가 완료되었습니다.</div>
      </div>
    </div>

    <div class="thin"></div>

    <!-- 사진 자리 표시 -->
    <section class="portrait-ph">사진 자리</section>

    <!-- 카카오톡 공유 -->
    <section class="share-box">
      <button id="kakaoShare" class="share-btn">카카오톡으로 초대장 보내기</button>
    </section>

  </main>

  <script>
    // 안전 보호막: JS 오류가 나도 화면은 떠야 합니다.
    (function(){
      try{
        // 애니메이션 트리거
        (function(){
          const REDUCED = matchMedia('(prefers-reduced-motion: reduce)').matches;
          const targets = document.querySelectorAll('.reveal-up');
          if(REDUCED){ targets.forEach(el=>el.classList.add('show')); return; }
          function fallback(){
            const vh=innerHeight;
            targets.forEach(el=>{
              if(el.classList.contains('show')) return;
              const r=el.getBoundingClientRect();
              if(r.top<=vh && r.bottom>0) el.classList.add('show');
            });
          }
          if(!('IntersectionObserver' in window)){
            addEventListener('scroll',fallback,{passive:true}); addEventListener('resize',fallback);
            addEventListener('load',fallback); fallback();
          }else{
            const io=new IntersectionObserver((es)=>{
              es.forEach(e=>{
                if(e.isIntersecting){ e.target.classList.add('show'); io.unobserve(e.target); }
              });
            },{threshold:0, rootMargin:'-100% 0px 0px 0px'});
            targets.forEach(el=>io.observe(el));
            addEventListener('load',fallback);
          }
        })();

        // 카운트다운
        (function(){
          const $past = document.getElementById('countPast');
          const $fut  = document.getElementById('countFuture');
          if(!$past || !$fut) return;
          const past   = new Date('2012-06-09T08:30:00+09:00');
          const future = new Date('2025-11-01T14:00:00+09:00');
          function setTimer(root, d,h,m,s){
            root.querySelector('.d').textContent=String(d).padStart(2,'0');
            root.querySelector('.h').textContent=String(h).padStart(2,'0');
            root.querySelector('.m').textContent=String(m).padStart(2,'0');
            root.querySelector('.s').textContent=String(s).padStart(2,'0');
          }
          function render(){
            const now=new Date();
            let t1=Math.max(0, now - past);
            const d1=Math.floor(t1/86400000); t1-=d1*86400000;
            const h1=Math.floor(t1/3600000);  t1-=h1*3600000;
            const m1=Math.floor(t1/60000);    t1-=m1*60000;
            const s1=Math.floor(t1/1000);
            setTimer($past, d1,h1,m1,s1);

            let t2=Math.max(0, future - now);
            const d2=Math.floor(t2/86400000); t2-=d2*86400000;
            const h2=Math.floor(t2/3600000);  t2-=h2*3600000;
            const m2=Math.floor(t2/60000);    t2-=m2*60000;
            const s2=Math.floor(t2/1000);
            setTimer($fut, d2,h2,m2,s2);
          }
          render(); setInterval(render,1000);
        })();

        // 갤러리 (이미지 배열 비워도 화면은 표시됨)
        (function(){
          const hero = document.getElementById('heroImg');
          const thumbs = document.getElementById('thumbs');
          const prev = document.getElementById('prevBtn');
          const next = document.getElementById('nextBtn');
          if(!hero || !thumbs || !prev || !next) return;

          const ALL = [
            // 'image/hero1.jpg','image/hero2.jpg', ...
          ];
          function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}
          const list = shuffle(ALL.slice());
          let idx = 0;
          function show(i){
            if(!list.length){ hero.alt='이미지 준비중'; return; }
            idx=(i+list.length)%list.length; hero.src=list[idx]+'?v=1';
          }
          show(0);
          prev.addEventListener('click', ()=> show(idx-1));
          next.addEventListener('click', ()=> show(idx+1));
          list.forEach((src,i)=>{
            const b=document.createElement('button');
            const im=document.createElement('img');
            im.src=src+'?v=1'; im.alt='썸네일'; b.appendChild(im);
            b.addEventListener('click',()=>show(i));
            thumbs.appendChild(b);
          });
        })();

        // 방명록 (구글시트 연동 스크립트는 별도로 붙여두셨다면 그대로 유지)
        // 여기선 빈 상태로 표시만

        // 계좌 복사 + 토글
        (function(){
          const copyModal=document.getElementById('copyModal');
          const copyClose=document.getElementById('copyClose');
          if(copyClose) copyClose.addEventListener('click',()=>copyModal.classList.remove('open'));
          document.addEventListener('click',(e)=>{
            const btn=e.target.closest('.copy-mini');
            if(!btn) return;
            const txt=btn.getAttribute('data-copy')||'';
            if(navigator.clipboard){
              navigator.clipboard.writeText(txt).then(()=>copyModal.classList.add('open'));
            }else{
              // 폴백
              const ta=document.createElement('textarea'); ta.value=txt; document.body.appendChild(ta);
              ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
              alert('복사되었습니다.');
            }
          });
          document.querySelectorAll('.acc-toggle').forEach(btn=>{
            btn.addEventListener('click', ()=>{
              const sel=btn.getAttribute('data-target');
              const panel=document.querySelector(sel);
              const open=btn.getAttribute('aria-expanded')==='true';
              btn.setAttribute('aria-expanded', String(!open));
              if(open){ panel.classList.remove('open'); panel.hidden=true; }
              else { panel.hidden=false; panel.classList.add('open'); }
            });
          });
        })();

        // 공유
        (function(){
          const k=document.getElementById('kakaoShare');
          if(!k) return;
          k.addEventListener('click',()=>{
            const data={title:document.title, text:'초대합니다', url:location.href};
            if(navigator.share){ navigator.share(data); }
            else { navigator.clipboard.writeText(location.href); alert('링크가 복사되었습니다. 카카오톡에 붙여넣어 보내주세요.'); }
          });
        })();

      }catch(err){
        // 혹시 모를 스크립트 오류를 화면에 보여주기 (디버그용)
        console.error(err);
        const pre=document.createElement('pre');
        pre.textContent='스크립트 오류: '+String(err);
        pre.style.cssText='padding:12px; background:#fee; color:#900; white-space:pre-wrap;';
        document.body.prepend(pre);
      }
    })();
  </script>
</body>
</html>
